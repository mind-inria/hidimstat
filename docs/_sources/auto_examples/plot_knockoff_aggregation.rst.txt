
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_knockoff_aggregation.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_plot_knockoff_aggregation.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_knockoff_aggregation.py:


Knockoff aggregation on simulated data
======================================

In this example, we show an example of variable selection using
model-X Knockoffs introduced by :footcite:t:`candes2018panning`. A notable
drawback of this procedure is the randomness associated with
the knockoff generation process. This can result in unstable
inference.

This example exhibits the two aggregation procedures described
by :footcite:t:`pmlr-v119-nguyen20a` and :footcite:t:`Ren_2023` to derandomize
inference.

References
----------
.. footbibliography::

.. GENERATED FROM PYTHON SOURCE LINES 22-24

Imports needed for this script
------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 24-179

.. code-block:: Python


    import matplotlib.pyplot as plt
    import numpy as np
    from sklearn.linear_model import LassoCV
    from sklearn.model_selection import KFold
    from sklearn.utils import check_random_state

    from hidimstat.knockoffs import (
        model_x_knockoff,
        model_x_knockoff_bootstrap_e_value,
        model_x_knockoff_bootstrap_quantile,
        model_x_knockoff_pvalue,
    )
    from hidimstat.statistical_tools.multiple_testing import fdp_power
    from hidimstat._utils.scenario import multivariate_1D_simulation_AR

    plt.rcParams.update({"font.size": 26})

    # Number of observations
    n_subjects = 500
    # Number of variables
    n_clusters = 500
    # Correlation parameter
    rho = 0.7
    # Ratio of number of variables with non-zero coefficients over total
    # coefficients
    sparsity = 0.1
    # Desired controlled False Discovery Rate (FDR) level
    fdr = 0.1
    seed = 45
    n_bootstraps = 25
    n_jobs = 10
    runs = 20

    rng = check_random_state(seed)
    seed_list = rng.randint(1, np.iinfo(np.int32).max, runs)


    def single_run(
        n_subjects, n_clusters, rho, sparsity, fdr, n_bootstraps, n_jobs, seed=None
    ):
        # Generate data
        X, y, _, non_zero_index = multivariate_1D_simulation_AR(
            n_subjects, n_clusters, rho=rho, sparsity=sparsity, seed=seed
        )

        # Use model-X Knockoffs [1]
        selected, test_scores, threshold, X_tildes = model_x_knockoff(
            X,
            y,
            estimator=LassoCV(
                n_jobs=n_jobs,
                verbose=0,
                max_iter=1000,
                cv=KFold(n_splits=5, shuffle=True, random_state=0),
                tol=1e-6,
            ),
            n_bootstraps=1,
            random_state=seed,
        )
        mx_selection, _ = model_x_knockoff_pvalue(test_scores, fdr=fdr)
        fdp_mx, power_mx = fdp_power(mx_selection, non_zero_index)

        # Use p-values aggregation [2]
        selected, test_scores, threshold, X_tildes = model_x_knockoff(
            X,
            y,
            estimator=LassoCV(
                n_jobs=n_jobs,
                verbose=0,
                max_iter=1000,
                cv=KFold(n_splits=5, shuffle=True, random_state=0),
                tol=1e-6,
            ),
            n_bootstraps=n_bootstraps,
            n_jobs=n_jobs,
            random_state=seed,
        )
        aggregated_ko_selection, _, _ = model_x_knockoff_bootstrap_quantile(
            test_scores, fdr=fdr, gamma=0.3
        )

        fdp_pval, power_pval = fdp_power(aggregated_ko_selection, non_zero_index)

        # Use e-values aggregation [1]
        eval_selection, _, _ = model_x_knockoff_bootstrap_e_value(
            test_scores, threshold, fdr=fdr
        )

        fdp_eval, power_eval = fdp_power(eval_selection, non_zero_index)

        return fdp_mx, fdp_pval, fdp_eval, power_mx, power_pval, power_eval


    fdps_mx = []
    fdps_pval = []
    fdps_eval = []
    powers_mx = []
    powers_pval = []
    powers_eval = []

    for seed in seed_list:
        fdp_mx, fdp_pval, fdp_eval, power_mx, power_pval, power_eval = single_run(
            n_subjects, n_clusters, rho, sparsity, fdr, n_bootstraps, n_jobs, seed=seed
        )
        fdps_mx.append(fdp_mx)
        fdps_pval.append(fdp_pval)
        fdps_eval.append(fdp_eval)

        powers_mx.append(fdp_mx)
        powers_pval.append(power_pval)
        powers_eval.append(power_eval)

    # Plot FDP and Power distributions

    fdps = [fdps_mx, fdps_pval, fdps_eval]
    powers = [powers_mx, powers_pval, powers_eval]


    def plot_results(bounds, fdr, nsubjects, n_clusters, rho, power=False):
        plt.figure(figsize=(10, 10), layout="constrained")
        for nb in range(len(bounds)):
            for i in range(len(bounds[nb])):
                y = bounds[nb][i]
                x = np.random.normal(nb + 1, 0.05)
                plt.scatter(x, y, alpha=0.65, c="blue")

        plt.boxplot(bounds, sym="")
        if power:
            plt.xticks(
                [1, 2, 3],
                ["MX Knockoffs", "Quantile aggregation", "e-values aggregation"],
                rotation=45,
                ha="right",
            )
            plt.title(f"FDR = {fdr}, n = {nsubjects}, p = {n_clusters}, rho = {rho}")
            plt.ylabel("Empirical Power")

        else:
            plt.hlines(fdr, xmin=0.5, xmax=3.5, label="Requested FDR control", color="red")
            plt.xticks(
                [1, 2, 3],
                ["MX Knockoffs", "Quantile aggregation", "e-values aggregation"],
                rotation=45,
                ha="right",
            )
            plt.title(f"FDR = {fdr}, n = {nsubjects}, p = {n_clusters}, rho = {rho}")
            plt.ylabel("Empirical FDP")
            plt.legend(loc="best")

        plt.show()


    plot_results(fdps, fdr, n_subjects, n_clusters, rho)
    plot_results(powers, fdr, n_subjects, n_clusters, rho, power=True)



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_knockoff_aggregation_001.png
         :alt: FDR = 0.1, n = 500, p = 500, rho = 0.7
         :srcset: /auto_examples/images/sphx_glr_plot_knockoff_aggregation_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/images/sphx_glr_plot_knockoff_aggregation_002.png
         :alt: FDR = 0.1, n = 500, p = 500, rho = 0.7
         :srcset: /auto_examples/images/sphx_glr_plot_knockoff_aggregation_002.png
         :class: sphx-glr-multi-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.787e+00, tolerance: 4.373e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 4.072e+00, tolerance: 4.467e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.874e+00, tolerance: 4.485e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.724e+00, tolerance: 4.153e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.847e+00, tolerance: 4.333e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.863e+00, tolerance: 3.817e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.581e+00, tolerance: 3.819e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.773e+00, tolerance: 3.791e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.659e+00, tolerance: 3.890e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.964e+00, tolerance: 3.861e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.386e+00, tolerance: 3.744e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.409e+00, tolerance: 3.455e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.459e+00, tolerance: 3.477e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.450e+00, tolerance: 3.675e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.290e+00, tolerance: 3.848e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.727e+00, tolerance: 3.564e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.709e+00, tolerance: 3.623e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.920e+00, tolerance: 3.225e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.799e+00, tolerance: 3.641e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.786e+00, tolerance: 3.557e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.318e+00, tolerance: 3.730e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.126e+00, tolerance: 3.448e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.098e+00, tolerance: 3.525e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.839e+00, tolerance: 3.383e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.856e+00, tolerance: 3.754e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.283e+00, tolerance: 3.526e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.122e+00, tolerance: 3.580e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.256e+00, tolerance: 3.676e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.630e+00, tolerance: 3.917e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.364e+00, tolerance: 3.730e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.171e+00, tolerance: 4.006e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.204e+00, tolerance: 4.314e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.185e+00, tolerance: 3.848e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.115e+00, tolerance: 4.337e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.308e+00, tolerance: 3.758e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.352e+00, tolerance: 3.359e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.249e+00, tolerance: 3.043e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.387e+00, tolerance: 3.329e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.238e+00, tolerance: 3.126e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.204e+00, tolerance: 2.922e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.843e+00, tolerance: 3.543e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.020e+00, tolerance: 3.502e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.102e+00, tolerance: 3.509e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.922e+00, tolerance: 3.445e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.899e+00, tolerance: 3.588e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.498e+00, tolerance: 3.180e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.789e+00, tolerance: 3.247e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.291e+00, tolerance: 3.364e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.662e+00, tolerance: 3.149e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.614e+00, tolerance: 3.375e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.371e+00, tolerance: 3.786e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.368e+00, tolerance: 3.526e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.709e+00, tolerance: 3.776e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.341e+00, tolerance: 3.717e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.450e+00, tolerance: 3.827e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.873e+00, tolerance: 3.710e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.870e+00, tolerance: 3.551e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.765e+00, tolerance: 3.600e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.825e+00, tolerance: 3.595e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.686e+00, tolerance: 3.401e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.580e+00, tolerance: 3.481e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.737e+00, tolerance: 3.383e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.511e+00, tolerance: 3.274e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.254e+00, tolerance: 3.384e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.504e+00, tolerance: 3.006e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.274e+00, tolerance: 3.490e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.413e+00, tolerance: 3.496e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.671e+00, tolerance: 3.581e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.654e+00, tolerance: 3.586e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.256e+00, tolerance: 3.672e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.567e+00, tolerance: 4.265e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.981e+00, tolerance: 3.968e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.014e+00, tolerance: 3.851e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.403e+00, tolerance: 3.851e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.278e+00, tolerance: 3.895e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.542e+00, tolerance: 4.034e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.690e+00, tolerance: 3.814e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.734e+00, tolerance: 3.720e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.275e+00, tolerance: 3.802e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.796e+00, tolerance: 3.711e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.788e+00, tolerance: 3.529e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.526e+00, tolerance: 3.503e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.737e+00, tolerance: 3.604e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.933e+00, tolerance: 3.824e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.888e+00, tolerance: 3.471e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.123e+00, tolerance: 3.243e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.269e+00, tolerance: 3.100e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.224e+00, tolerance: 3.139e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.091e+00, tolerance: 3.232e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.194e+00, tolerance: 3.215e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.060e+00, tolerance: 3.657e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.407e+00, tolerance: 3.723e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.385e+00, tolerance: 3.491e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.254e+00, tolerance: 3.500e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 3.136e+00, tolerance: 3.458e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.709e+00, tolerance: 3.635e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.565e+00, tolerance: 3.325e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.865e+00, tolerance: 3.496e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.634e+00, tolerance: 3.301e-02
      model = cd_fast.enet_coordinate_descent(
    /opt/hostedtoolcache/Python/3.12.10/x64/lib/python3.12/site-packages/sklearn/linear_model/_coordinate_descent.py:695: ConvergenceWarning: Objective did not converge. You might want to increase the number of iterations, check the scale of the features or consider increasing regularisation. Duality gap: 2.606e+00, tolerance: 3.476e-02
      model = cd_fast.enet_coordinate_descent(
    /home/runner/work/hidimstat/hidimstat/src/hidimstat/gaussian_knockoff.py:183: UserWarning: The equi-correlated matrix for knockoffs is not positive definite. Reduce the value of distance.
      warnings.warn(





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (4 minutes 57.530 seconds)

**Estimated memory usage:**  367 MB


.. _sphx_glr_download_auto_examples_plot_knockoff_aggregation.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_knockoff_aggregation.ipynb <plot_knockoff_aggregation.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_knockoff_aggregation.py <plot_knockoff_aggregation.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_knockoff_aggregation.zip <plot_knockoff_aggregation.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
